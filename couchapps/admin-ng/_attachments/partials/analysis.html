<div class="analysis">

  <h2><contestant bib="$ctrl.bib" infos="infos"></contestant></h2>

  <uib-progressbar ng-show="$ctrl.maxKms" max="$ctrl.maxKms" value="$ctrl.currentKms">
    {{$ctrl.currentKms | digitsUnit: 2: "km"}} / {{$ctrl.maxKms | digitsUnit: 2: "km"}}
  </uib-progressbar>

  <div ng-if="$ctrl.needsFixing" class="alert {{$ctrl.analysis.valid ? 'alert-warning' : 'alert-danger' }}">
    Anomalies: {{$ctrl.analysis.anomalies}}
    <span ng-if="!$ctrl.analysis.valid">(invalid entry, removed from rankings)</span>
  </div>

  <div class="panel panel-primary">
    <div class="panel-heading"><h4 class="panel-title">Possible actions</h4></div>
    <analysis-summary points="$ctrl.analysis.checkpoints" analysis="$ctrl.analysis" active="true" infos="infos">
    </analysis-summary>
  </div>

  <div ng-if="$ctrl.needsFixing" class="panel panel-warning">
    <div class="panel-heading"><h4 class="panel-title">Before modifications</h4></div>
    <analysis-summary points="$ctrl.analysis.before" analysis="$ctrl.analysis" active="false" infos="infos">
    </analysis-summary>
  </div>

  <div ng-if="$ctrl.needsFixing" class="panel panel-success">
    <div class="panel-heading"><h4 class="panel-title">After modifications</h4></div>
    <analysis-summary ng-if="$ctrl.needsFixing" points="$ctrl.analysis.after" analysis="$ctrl.analysis" active="false" infos="infos">
    </analysis-summary>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading"><h4 class="panel-title">Sent SMS</h4></div>
    <div class="panel-body">
      <sent bib="$ctrl.bib"></sent>
    </div>
  </div>
</div>
